extends layout

block content
  .spacer
  .row
    .span8
      h3 Tracciamento #{user.name}
      
  hr

  .row
    .span12
      
      p Di seguito trovi i dettagli del tracciamento di #{user.name} per il corso #{course.name}.
        | Le azioni sono visualizzate in ordine cronologico dalla più recente (in alto) alla prima eseguita (in fondo).
        br
        |  Sono tracciate le seguenti tipologie di evento: 
        b iscrizione (enrollment), iniziato, sospeso, abbandonato, completato
        | . Per alcune tipolgie di tracciamento sono previsti dettagli aggiuntivi.
      
      p
        b Dati Utente: 
        span 
          a(href='mailto:#{user.email}') #{user.name}
          | , #{user.company} 
          | (username: #{user.username})
          
        br
        b Dati Corso: 
        span #{course.name} creato il #{moment(course.created_on).format('LLL')}

  hr

  .row
    .span12
      
      h5 Tracciamento
      
      if report.events && report.events.length > 0
        table.table.table-striped#user-table
          thead
            tr
              th.span3 Data
              th.span3 Descrizione
              th.span6 Dettagli
          tbody
            
          for event in report.events
            tr
              td #{moment(event.created_on).format('LLL')}
              if event.type === 'enrollment'
                td #{event.description}
                td &ndash;
              else
                td(colspan=2)
                  span.label.label-important Errore
                  |  tracciamento sconosciuto
              
      else
        .alert.alert-danger.alert-block
          p 
            strong Errore della piattaforma
            br
            | Non è stato tracciato nessun evento per questo report (tuttavia almeno un record di enrollment dovrebbe essere presente).
            br
            | Per favore, contatta il supporto fornendo il seguente riferimento: #{report._id}.
